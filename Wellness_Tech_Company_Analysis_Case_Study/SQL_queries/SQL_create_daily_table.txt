-- combining dailyActivity_merged and dailyCalories_merged

CREATE TABLE IF NOT EXISTS daily AS
    SELECT
        a.*
    FROM
        dailyActivity_merged AS a
    INNER JOIN
        dailyCalories_merged AS c
    ON
        a.Id = c.Id AND
        a.ActivityDate = c.ActivityDay AND
        a.Calories = c.Calories;


-- combining daily and dailyIntensities_merged

CREATE TABLE IF NOT EXISTS daily2 AS
    SELECT
        d.*
    FROM
        daily AS d
    JOIN
        dailyIntensities_merged AS i
    ON
        d.Id = i.Id AND
        d.ActivityDate = i.ActivityDay AND
        d.FairlyActiveMinutes = i.FairlyActiveMinutes AND
        d.LightActiveDistance = i.LightActiveDistance AND
        d.LightlyActiveMinutes = i.LightlyActiveMinutes AND
        d.ModeratelyActiveDistance = i.ModeratelyActiveDistance AND
        d.SedentaryActiveDistance = i.SedentaryActiveDistance AND
        d.SedentaryMinutes = i.SedentaryMinutes AND
        d.VeryActiveDistance = i.VeryActiveDistance AND
        d.VeryActiveMinutes = i.VeryActiveMinutes;


-- combining daily2 and dailySteps_merged

CREATE TABLE IF NOT EXISTS daily3 AS
    SELECT
        d.*
    FROM
        daily2 AS d
    JOIN
        dailySteps_merged AS s
    ON
        d.Id = s.Id AND
        d.ActivityDate = s.ActivityDay;


-- combining daily3 and sleepDay_merged

CREATE TABLE IF NOT EXISTS daily4 AS
    SELECT
        d.*,
        s.SleepDay,
        s.TotalMinutesAsleep,
        s.TotalSleepRecords,
        s.TotalTimeInBed
    FROM
        daily3 AS d
    JOIN
        sleepDay_merged AS s
    ON
        d.Id = s.Id


-- deleting old tables
DROP TABLE IF EXISTS daily;
DROP TABLE IF EXISTS daily2;
DROP TABLE IF EXISTS daily3;

-- renaming daily4 to daily
ALTER TABLE daily4 RENAME TO daily;